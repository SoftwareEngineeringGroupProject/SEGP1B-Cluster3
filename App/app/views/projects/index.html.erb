<%= render "shared/header" %>
<%= render "shared/linkbar" %>
<%= render "shared/banner" %>

<div class="wrapper content">
	<div id="news" class="flex_height shadow">
		<div class="contact-title">
			<h1><strong>Project Portfolio</strong></h1>
		</div>

		<h2><%= flash[:notice] %></h2>

		<!--filter bar here-->
		<div class="filter-bar to_left">
			<!--add some ground options here-->
			<%=form_tag index_path, :method => 'get' do %>
			<span class="to_left"> <%= select_tag "year", options_from_collection_for_select(@projects, "year", "year"), prompt: "Year"%> </span>
			<span class="to_left"> <%= select_tag "category", options_from_collection_for_select(@projects, "category", "category"), prompt: "Category"%> </span>
			<span class="to_right"><%= submit_tag "Filter"%></span>
			<%end%>
		</div>
		<!----------filter bar end---------->

		<!--search bar here-->
		<div class="search-bar to_right">

			<!--add some ground options here-->
			<% grouped_options = {'PastProject' => ['ID', 'Title', 'Year', 'Category', 'Client Name'],'Student' => ['Name', ['ID', 'Student ID'], ['Degree', 'Course'], 'Email']}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                @options=grouped_options_for_select(grouped_options, 'Title')%>
			<%=form_tag search_path, :method => 'get' do %>
			<span class="to_left"> <%= select_tag "classify", options_for_select(@options )%> </span>
			<span class="to_left"><%= text_field_tag :search, params[:search], placeholder: "Search..."%></span>
			<span class="to_right"><%= submit_tag "Search"%></span>
			<%end%>
		</div>
		<!----------search bar end---------->

		<div class="project-container">

			<!-------------------execute filting here------------------>

			<%if (@year!="") && (@category!="") %>
			<% @filteredProjects=StudentProject.where("year=? and category=?", @year, @category)%>
			<% for project in @filteredProjects %>

			<div class="project-index-image">
				<!--<!%= image_tag project.image_url(:thumb)  %>-->
				<!--route to a related project with specific ID-->
				<%= link_to(image_tag(project.image), project_path(project.id))%>
				Project Title: <%= project.title %></br>
			</div>
			<% end %>

			<%elsif @year!=""%>
			<% @filteredProjects=StudentProject.where("year=?", @year)%>
			<% for project in @filteredProjects %>

			<div class="project-index-image">
				<!--<!%= image_tag project.image_url(:thumb)  %>-->
				<!--route to a related project with specific ID-->
				<%= link_to(image_tag(project.image), project_path(project.id))%>
				Project Title: <%= project.title %></br>
			</div>
			<% end %>

			<%elsif @category!=""%>
			<%@filteredProjects=StudentProject.where("category=?", @category)%>
			<% for project in @filteredProjects %>

			<div class="project-index-image">
				<!--<!%= image_tag project.image_url(:thumb)  %>-->
				<!--route to a related project with specific ID-->
				<%= link_to(image_tag(project.image), project_path(project.id))%>
				Project Title: <%= project.title %></br>
			</div>
			<% end%>
			<!-------------------execute filting end------------------>
			<%else%>
			<% for project in @projects %>

			<div class="project-index-image">
				<!--<!%= image_tag project.image_url(:thumb)  %>-->
				<!--route to a related project with specific ID-->
				<%= link_to(image_tag(project.image), project_path(project.id))%>
				Project Title: <%= project.title %></br>
			</div>
			<% end %>
			<% end %>
		</div>
	</div>

</div>
<%= render "shared/footer" %>
